
<!DOCTYPE html>
<html class="no-js" lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="light dark" />
    
    <meta name="docsearch:name" content="dfreproject" />
    <meta name="docsearch:package_type" content="" />
    <meta name="docsearch:release" content="" />
    <meta name="docsearch:version" content="" />
    
      <meta name="theme-color" content="#0DCAF0" />
    
    
      <title>Astronomical Coordinate Transformations &mdash; dfreproject  documentation</title>
    
    <link rel="canonical" href="methodology" />
          <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8e8a900e" /><!-- add (1) -->
          <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" /><!-- add (1) -->
          <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" /><!-- add (1) -->
          <link rel="stylesheet" type="text/css" href="_static/sphinx-nefertiti-default.min.css?v=0c1bdb5f" /><!-- add (1) -->
          <link rel="stylesheet" type="text/css" href="_static/fonts/nunito/stylesheet.css?v=abf98f06" /><!-- add (1) -->
          <link rel="stylesheet" type="text/css" href="_static/fonts/ubuntu-sans-mono/stylesheet.css?v=8616a587" /><!-- add (1) -->
          <link rel="stylesheet" type="text/css" href="_static/pygments-dark.css?v=2de69186" /><!-- add (1) -->
          <link rel="stylesheet" type="text/css" href="_static/pygments-light.css?v=970f37b1" /><!-- add (1) -->
          <link rel="stylesheet" type="text/css" href="_static/bootstrap-icons.min.css?v=44730005" /><!-- add (1) -->
        <link rel="index" title="Index" href="genindex.html" />
        <link rel="search" title="Search" href="search.html" />
        <link rel="top" title="dfreproject  documentation" href="#" />
        <link rel="next" title="Examples" href="examples.html" />
        <link rel="prev" title="Welcome to dfreproject’s documentation!" href="index.html" />
    <style>
      :root {
        --nftt-body-font-family: "Nunito", var(--nftt-font-sans-serif) !important;
        --nftt-font-monospace: "Ubuntu Sans Mono", var(--nftt-font-family-monospace) !important;
        --nftt-project-name-font: var(--nftt-body-font-family);
        --nftt-documentation-font: var(--nftt-body-font-family);
        --nftt-doc-headers-font: "Georgia", var(--nftt-documentation-font);}

      h1 *,
      h2 *,
      h3 *,
      h4 *,
      h5 *,
      h6 * {
        font-size: inherit;
      }

      .light pre,
      .dark pre {
        line-height: var(--nftt-pre-line-height, 140%);
      }
    </style>
  </head>
  <body>
    <div id="back-to-top-container" class="position-fixed start-50 translate-middle-x">
      <button id="back-to-top" type="button" class="d-none btn btn-neutral btn-sm shadow px-4" data-bs-toggle="button">Back to top</button>
    </div>
    <header id="snftt-nav-bar" class="navbar navbar-expand-xl navbar-dark nftt-navbar flex-column fixed-top">
      <div class="skip-links container-fluid visually-hidden-focusable overflow-hidden justify-content-start flex-grow-1">
        <div class="border-bottom mb-2 pb-2 w-100">
          <a class="d-none d-md-inline-flex p-2 m-1" href="#sidebar-filter">Skip to index filter</a>
          <a class="d-inline-flex p-2 m-1" href="#content">Skip to main content</a>
        </div>
      </div>
      <nav class="container-xxl nftt-gutter flex-nowrap" aria-label="Main navigation">
        <div class="nftt-navbar-toggler">
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-controls="sidebar" aria-label="Toggle documentation navigation">
            <i class="bi bi-list"></i>
          </button>
        </div>
          <a href="index.html"
             class="navbar-brand"
          ><span class="brand-text">dfreproject</span><span class="brand-short-text">dfreproject</span></a>
        
        
        <div class="d-flex d-xl-none">
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#nfttSearch" aria-controls="nfttSearch" aria-label="Search">
            <i class="bi bi-search"></i>
          </button>
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#nfttNavbar" aria-controls="nfttNavbar" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
        </div>
        
<div class="offcanvas-xl offcanvas-end flex-grow-1" tabindex="-1" id="nfttSearch" aria-labelledby="nfttSearchOffcanvasLabel" data-bs-scroll="true">
  <div class="offcanvas-header px-4 pb-0">
    <h5 class="offcanvas-title fw-bold" id="nfttSearchOffcanvasLabel">Search the documentation</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#nfttSearch"></button>
  </div>
  <div class="offcanvas-body p-4 pt-0 p-xl-0 ps-xl-4">
    <hr class="d-xl-none text-white-50">
    <ul class="navbar-nav flex-row align-items-center flex-wrap ms-md-auto">
      <li class="nav-item col-12 col-xl-auto">
        <form id="nftt-search-form" action="search.html" method="get">
          <div class="input-group">
            <input type="text" name="q" class="form-control search-input" placeholder="Search" aria-label="Search" aria-describedby="button-search">
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <button class="btn btn-primary" type="submit" id="button-search" aria-label="Search"><i class="bi bi-search"></i></button>
          </div>
        </form>
      </li>
    </ul>
  </div>
</div>

        <div class="offcanvas-xl offcanvas-end" tabindex="-1" id="nfttNavbar" aria-labelledby="nfttNavbarOffcanvasLabel" data-bs-scroll="true">
          <div class="offcanvas-header px-4 pb-0">
            <div class="offcanvas-title navbar-brand" id="nfttNavbarOffcanvasLabel"><span class="brand-short-text">dfreproject</span></div>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#nfttNavbar"></button>
          </div>
          <div class="offcanvas-body p-4 pt-0 p-xl-0 px-xl-3">
            <hr class="d-xl-none text-white-50">
            <ul class="navbar-nav flex-row align-items-center flex-wrap ms-lg-auto">
              
              
              
              
              
              <!-- lightdark-dropdown.html -->
<li class="nav-item dropdown">
  <a class="nav-link d-flex py-2 px-0 px-xl-2 dropdown-toggle align-items-center" id="snftt-luz" href="#" data-bs-toggle="dropdown" data-bs-display="static" aria-expanded="false" aria-label="Change appearance">
    <i class="bi bi-circle-half" data-snftt-luz-icon-active></i>
    <span id="snftt-luz-text" class="d-xl-none ms-2">Change appearance</span>
  </a>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="snftt-luz-text">
    <li>
      <h6 class="dropdown-header">Change appearance</h6>
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" data-snftt-luz="light" href="#" aria-pressed="false">
        <span>
          <i class="bi bi-sun" data-snftt-luz-icon="light"></i>
        </span>
        <span class="ms-3">Light</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" data-snftt-luz="dark" href="#" aria-pressed="false">
        <span>
          <i class="bi bi-moon-stars" data-snftt-luz-icon="dark"></i>
        </span>
        <span class="ms-3">Dark</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
    <li>
      <a class="dropdown-item current d-flex align-items-center" data-snftt-luz="default" href="#" aria-pressed="false">
        <span>
          <i class="bi bi-circle-half" data-snftt-luz-icon="default"></i>
        </span>
        <span class="ms-3">Automatic</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
  </ul>
</li>
            </ul>
          </div>
        </div>
      </nav>
      
    </header>

    <div class="container-fluid flex-grow-1">
      <div class="nftt-gutter nftt-page">
        <aside class="nftt-sidebar ">
          <div class="nftt-sidebar-content">
            
            <div class="title d-none d-xl-none">
              <i class="bi bi-book"></i>&nbsp;&nbsp;<span>Index</span>
            </div>
            <div id="sidebar" tabindex="-1" class="offcanvas-xl offcanvas-start" aria-labelledby="nfttSidebarOffcanvasLabel">
                <!-- sidebartemplate: "globaltoc.html" --><div class="offcanvas-header border-bottom">
  <h5 class="offcanvas-title fw-bold" id="nfttSidebarOffcanvasLabel">
    Index
  </h5>
  <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#sidebar"></button>
</div>

<div class="offcanvas-body">
  <nav class="toc" aria-label="Main menu">
    <div class="mb-3 p-1 pb-4 border-bottom">
      <input id="sidebar-filter" type="text" name="filter" class="form-control form-control-sm" placeholder="index filter" aria-label="index filter">
    </div>
    <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Astronomical Coordinate Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/reprojection-comparison.html">Test of reprojection</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Coordinate-Comparison.html">Comparison of Astropy vs Torch implementation of coordinate transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/reprojection-comparison-mini.html">Comparison of interpolation methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="autoapi/dfreproject/index.html">dfreproject</a><ul>
<li class="toctree-l3"><a class="reference internal" href="autoapi/dfreproject/lanczos/index.html">dfreproject.lanczos</a></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/dfreproject/reproject/index.html">dfreproject.reproject</a></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/dfreproject/sip/index.html">dfreproject.sip</a></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/dfreproject/tensorhdu/index.html">dfreproject.tensorhdu</a></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/dfreproject/utils/index.html">dfreproject.utils</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav>
  <template data-toggle-item-template>
    <button class="btn btn-sm btn-link toctree-expand" type="button">
      <i class="bi bi-caret-right"></i>
      <span class="visually-hidden">Toggle menu contents</span>
    </button>
  </template>
</div>
            </div>
            
          </div>
        </aside>
        <article id="content" class="nftt-content" role="main">
          <div>
            <nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="index.html">Start</a></li>
    <li class="breadcrumb-item active" aria-current="page">Astronomical Coordinate Transformations</li>
  </ol>
</nav>
    <section id="astronomical-coordinate-transformations">
<h1>Astronomical Coordinate Transformations<a class="headerlink" href="#astronomical-coordinate-transformations" title="Link to this heading">¶</a></h1>
<p>This module provides PyTorch-based implementations of astronomical coordinate transformations using the World Coordinate System (WCS) standard. These functions allow conversion between pixel coordinates and sky coordinates (RA/Dec) with support for the Tangential (TAN) projection and SIP distortion corrections.</p>
<section id="key-wcs-variables">
<h2>Key WCS Variables<a class="headerlink" href="#key-wcs-variables" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>CRPIX1, CRPIX2</strong>: Reference pixel coordinates (1-based in FITS convention)</p></li>
<li><p><strong>CRVAL1, CRVAL2</strong>: Reference point sky coordinates (RA, Dec) in degrees</p></li>
<li><p><strong>PC_matrix</strong>: Transformation matrix that encodes rotation</p></li>
<li><p><strong>CDELT</strong>: Pixel scale factors (degrees per pixel)</p></li>
<li><p><strong>CD_matrix</strong>: Combined transformation matrix (PC_matrix * CDELT)</p></li>
<li><p><strong>SIP coefficients</strong>: Parameters for the Simple Imaging Polynomial distortion correction</p></li>
</ul>
</section>
<section id="calculate-skycoords">
<h2>calculate_skyCoords<a class="headerlink" href="#calculate-skycoords" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculate_skyCoords">
<span class="sig-name descname"><span class="pre">calculate_skyCoords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#calculate_skyCoords" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>Convert pixel coordinates in the target image to sky coordinates (RA, Dec).</p>
<p>This function implements the forward transformation from pixel space to sky coordinates
following the same logic as the Astropy WCS implementation, but using PyTorch for
GPU acceleration and batch processing.</p>
<p>Takes optional pixel coordinates (x, y) as input and returns a tuple of (RA, Dec) coordinates in degrees.</p>
<p><strong>Key Steps:</strong></p>
<ol class="arabic simple">
<li><p><strong>Preprocessing</strong>: Compute pixel offsets from the reference pixel (CRPIX)</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}u = x - (CRPIX1 - 1)\\v = y - (CRPIX2 - 1)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(x, y\)</span> are input pixel coordinates and <span class="math notranslate nohighlight">\(CRPIX1, CRPIX2\)</span> are reference pixel coordinates.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><strong>SIP Correction</strong>: Apply SIP distortion correction if present</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[(u', v') = \text{apply_sip_distortion}(u, v)\]</div>
<p>where <span class="math notranslate nohighlight">\(u', v'\)</span> are the distorted coordinates after applying the SIP polynomial.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><strong>Linear Transformation</strong>: Apply the CD matrix (rotation and scaling)</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}CD\_matrix = PC\_matrix \cdot CDELT\\\begin{split}\begin{bmatrix} x_{scaled} \\ y_{scaled} \end{bmatrix} = CD\_matrix \cdot \begin{bmatrix} u' \\ v' \end{bmatrix}\end{split}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(PC\_matrix\)</span> is the coordinate rotation matrix, <span class="math notranslate nohighlight">\(CDELT\)</span> contains pixel scale factors,
and <span class="math notranslate nohighlight">\(x_{scaled}, y_{scaled}\)</span> are intermediate coordinates in a standard plane.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p><strong>Tangential Projection</strong>: Convert to angular coordinates using the TAN projection</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}r = \sqrt{x_{scaled}^2 + y_{scaled}^2}\\\phi = \tan^{-1}(-x_{scaled}, y_{scaled}) \cdot \frac{180}{\pi}\\\theta = \tan^{-1}(r_0, r) \cdot \frac{180}{\pi}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(r_0 = \frac{180}{\pi}\)</span> is the radius scaling factor, <span class="math notranslate nohighlight">\(\phi\)</span> is the native longitude
and <span class="math notranslate nohighlight">\(\theta\)</span> is the native latitude in the celestial coordinate system.</p>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p><strong>Sky Coordinates Conversion</strong>: Transform to world coordinates (RA, Dec)</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sin(dec) = \sin(\theta) \cdot \sin(dec_0) + \cos(\theta) \cdot \cos(dec_0) \cdot \cos(\phi)\\dec = \sin^{-1}(\sin(dec))\\ra = ra_0 + \tan^{-1}(-\cos(\theta) \cdot \sin(\phi), \sin(\theta) \cdot \cos(dec_0) - \cos(\theta) \cdot \sin(dec_0) \cdot \cos(\phi))\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(ra_0, dec_0\)</span> are the reference point sky coordinates (CRVAL1, CRVAL2), and <span class="math notranslate nohighlight">\(ra, dec\)</span>
are the final right ascension and declination in degrees.</p>
</div></blockquote>
<p>The implementation faithfully reproduces the WCSLib computation steps for the TAN projection,
including precise handling of trigonometric functions and coordinate transformations.</p>
</section>
<section id="calculate-sourcecoords">
<h2>calculate_sourceCoords<a class="headerlink" href="#calculate-sourcecoords" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculate_sourceCoords">
<span class="sig-name descname"><span class="pre">calculate_sourceCoords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#calculate_sourceCoords" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculate source image pixel coordinates corresponding to each target image pixel.</p>
<p>This function performs the inverse transformation from the target image grid through
sky coordinates and back to pixel coordinates in the source image. This is especially
useful for image resampling and alignment tasks.</p>
<p>Returns source image pixel coordinates (x, y) corresponding to each target pixel.</p>
<p><strong>Key Steps:</strong></p>
<ol class="arabic simple">
<li><p><strong>Sky Coordinate Calculation</strong>: Obtain sky coordinates (RA, Dec) using <cite>calculate_skyCoords</cite></p></li>
<li><p><strong>World to Native Transformation</strong>: Convert world coordinates to native spherical coordinates</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\delta_{ra} = ra - ra_0\\y_{\phi} = -\cos(dec) \cdot \sin(\delta_{ra})\\x_{\phi} = \sin(dec) \cdot \cos(dec_0) - \cos(dec) \cdot \sin(dec_0) \cdot \cos(\delta_{ra})\\\phi = \tan^{-1}(y_{\phi}, x_{\phi}) \cdot \frac{180}{\pi}\\\theta = \sin^{-1}(\sin(dec) \cdot \sin(dec_0) + \cos(dec) \cdot \cos(dec_0) \cdot \cos(\delta_{ra})) \cdot \frac{180}{\pi}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(ra, dec\)</span> are the input sky coordinates, <span class="math notranslate nohighlight">\(ra_0, dec_0\)</span> are the reference point coordinates (CRVAL1, CRVAL2),
<span class="math notranslate nohighlight">\(\delta_{ra}\)</span> is the difference in right ascension, and <span class="math notranslate nohighlight">\(\phi, \theta\)</span> are native spherical coordinates.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><strong>Projection Inversion</strong>: Apply inverse TAN projection</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}r_0 = \frac{180}{\pi}\\r = r_0 \cdot \frac{\cos(\theta)}{\sin(\theta)}\\x_{scaled} = -r \cdot \sin(\phi)\\y_{scaled} = r \cdot \cos(\phi)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(r_0\)</span> is the radius scaling factor, <span class="math notranslate nohighlight">\(r\)</span> is the radial distance, and <span class="math notranslate nohighlight">\(x_{scaled}, y_{scaled}\)</span>
are intermediate coordinates in the standard projection plane.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p><strong>Linear Transformation</strong>: Apply inverse CD matrix to get pixel offsets</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}CD\_matrix = PC\_matrix \cdot CDELT\\\begin{split}\begin{bmatrix} u \\ v \end{bmatrix} = CD\_matrix^{-1} \cdot \begin{bmatrix} x_{scaled} \\ y_{scaled} \end{bmatrix}\end{split}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(CD\_matrix^{-1}\)</span> is the inverse of the combined transformation matrix, and <span class="math notranslate nohighlight">\(u, v\)</span> are pixel
offsets before SIP correction.</p>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p><strong>SIP Correction</strong>: Apply inverse SIP distortion correction if present</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[(u', v') = \text{apply_inverse_sip_distortion}(u, v)\]</div>
<p>where <span class="math notranslate nohighlight">\(u', v'\)</span> are the corrected pixel offsets after applying inverse SIP distortion.</p>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p><strong>Final Coordinates</strong>: Add reference pixel position to get final pixel coordinates</p></li>
</ol>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{pixel} = u' + (CRPIX1 - 1)\\y_{pixel} = v' + (CRPIX2 - 1)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(CRPIX1, CRPIX2\)</span> are the reference pixel coordinates, and <span class="math notranslate nohighlight">\(x_{pixel}, y_{pixel}\)</span> are
the final source image pixel coordinates.</p>
</div></blockquote>
<p>This implementation carefully handles the sign conventions and coordinate system transformations
required for accurate results, matching the behavior of the standard WCSLib implementation.</p>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Both functions support batch processing for efficient transformation of multiple coordinates</p></li>
<li><p>The code uses PyTorch tensors for GPU acceleration and differentiable operations</p></li>
<li><p>Special care is taken to handle edge cases like singularities in the projections</p></li>
<li><p>The implementation follows the WCSLib conventions for sign handling and coordinate transformations</p></li>
</ul>
</section>
</section>

</div>
        </article>
        <aside class="nftt-toc my-3">
          
          <div class="my-sm-1 my-lg-0 ps-xl-3 text-muted">
            <button class="btn btn-link p-lg-0 mb-2 mb-lg-0 text-decoration-none nftt-toc-toggle d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#tocContents" aria-expanded="false" aria-controls="tocContents"
            >On this page <i class="ms-2 bi bi-chevron-expand"></i></button>
            <div class="title d-none d-lg-block">
              <i class="bi bi-file-earmark-text"></i>&nbsp;&nbsp;<span class="small">On this page</span>
            </div>
            <div class="collapse nftt-toc-collapse" id="tocContents">
              <nav id="TableOfContents">
                <ul>
<li><a class="reference internal" href="#">Astronomical Coordinate Transformations</a><ul>
<li><a class="reference internal" href="#key-wcs-variables">Key WCS Variables</a></li>
<li><a class="reference internal" href="#calculate-skycoords">calculate_skyCoords</a><ul>
<li><a class="reference internal" href="#calculate_skyCoords"><code class="docutils literal notranslate"><span class="pre">calculate_skyCoords()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#calculate-sourcecoords">calculate_sourceCoords</a><ul>
<li><a class="reference internal" href="#calculate_sourceCoords"><code class="docutils literal notranslate"><span class="pre">calculate_sourceCoords()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
</ul>

              </nav>
            </div>
          </div>
          
        </aside>
      </div>
    </div>

    <footer class="nftt-footer">
      <nav id="paginator" class="py-4" aria-label="Documentation navigation">
    <div class="container">
      <ul class="pagination justify-content-between mb-0"><li class="d-flex page-item">
            <a href="index.html" class="d-flex px-5 align-items-end" rel="prev" aria-label="Previous page: Welcome to dfreproject’s documentation!">
              <span class="prev-page"><i class="bi bi-caret-left"></i></span>
              <div class="d-none d-sm-flex flex-column">
                <span class="text-small text-start text-muted">Previous</span>
                <span class="underline">Welcome to dfreproject’s documentation!</span>
              </div>
            </a>
          </li>
        <li class="d-flex page-item ms-auto">
            <a href="examples.html" class="d-flex px-5 align-items-end" rel="next" aria-label="Next page: Examples">
              <div class="d-flex flex-column">
                <span class="text-small text-end text-start text-muted">Next</span>
                <span class="underline">Examples</span>
              </div>
              <span class="next-page"><i class="bi bi-caret-right"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
  </nav>

      <div class="py-5 px-4 px-md-3">
  <div class="container">
    

    <div class="row">
      <div class="col-lg-12 text-center">
        <a class="brand-text d-inline-flex align-items-center mb-2 text-decoration-none" href="/" aria-label="dfreproject">
          <span class="fs-6 fw-bold">dfreproject</span>
        </a>
        
          <ul class="list-unstyled small text-muted">
            <li>2025, Carter Rhea</li>
          </ul>
        
        
        <div class="built-with pt-2">
          Built with <a href="http://sphinx-doc.org">Sphinx 8.1.3</a> and <a href="https://github.com/danirus/sphinx-nefertiti">Nefertiti 0.8.10</a>
        </div>
        
      </div>
    </div>
  </div>
</div>
    </footer>
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/docs-versions.js?v=08b0cbfb"></script>
    <script src="_static/sphinx-nefertiti.min.js?v=0d8c3777"></script>
    <script src="_static/bootstrap.bundle.min.js?v=647f0dd8"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>
</html>